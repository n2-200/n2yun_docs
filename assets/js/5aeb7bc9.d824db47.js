"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2026],{3905:(e,n,r)=>{r.d(n,{Zo:()=>u,kt:()=>f});var t=r(7294);function o(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function i(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function a(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?i(Object(r),!0).forEach((function(n){o(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function s(e,n){if(null==e)return{};var r,t,o=function(e,n){if(null==e)return{};var r,t,o={},i=Object.keys(e);for(t=0;t<i.length;t++)r=i[t],n.indexOf(r)>=0||(o[r]=e[r]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)r=i[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var l=t.createContext({}),c=function(e){var n=t.useContext(l),r=n;return e&&(r="function"==typeof e?e(n):a(a({},n),e)),r},u=function(e){var n=c(e.components);return t.createElement(l.Provider,{value:n},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},m=t.forwardRef((function(e,n){var r=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(r),m=o,f=d["".concat(l,".").concat(m)]||d[m]||p[m]||i;return r?t.createElement(f,a(a({ref:n},u),{},{components:r})):t.createElement(f,a({ref:n},u))}));function f(e,n){var r=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var i=r.length,a=new Array(i);a[0]=m;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[d]="string"==typeof e?e:o,a[1]=s;for(var c=2;c<i;c++)a[c]=r[c];return t.createElement.apply(null,a)}return t.createElement.apply(null,r)}m.displayName="MDXCreateElement"},5083:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var t=r(7462),o=(r(7294),r(3905));const i={description:"Learn about and how to use common core server functions!"},a="\ud83d\udda5 Server Function Reference",s={unversionedId:"qb-core/server-function-reference",id:"qb-core/server-function-reference",title:"\ud83d\udda5 Server Function Reference",description:"Learn about and how to use common core server functions!",source:"@site/docs/qb-core/server-function-reference.md",sourceDirName:"qb-core",slug:"/qb-core/server-function-reference",permalink:"/docs/qb-core/server-function-reference",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/qb-core/server-function-reference.md",tags:[],version:"current",frontMatter:{description:"Learn about and how to use common core server functions!"},sidebar:"tutorialSidebar",previous:{title:"\ud83d\udda5 Server Event Reference",permalink:"/docs/qb-core/server-event-reference"},next:{title:"\u2197 Shared Exports",permalink:"/docs/qb-core/shared-exports"}},l={},c=[{value:"QBCore.Functions.GetCoords",id:"qbcorefunctionsgetcoords",level:3},{value:"QBCore.Functions.GetIdentifier",id:"qbcorefunctionsgetidentifier",level:3},{value:"QBCore.Functions.GetSource",id:"qbcorefunctionsgetsource",level:3},{value:"QBCore.Functions.GetPlayer",id:"qbcorefunctionsgetplayer",level:3},{value:"QBCore.Functions.GetPlayerByCitizenId",id:"qbcorefunctionsgetplayerbycitizenid",level:3},{value:"QBCore.Functions.GetPlayerByPhone",id:"qbcorefunctionsgetplayerbyphone",level:3},{value:"QBCore.Functions.GetPlayers",id:"qbcorefunctionsgetplayers",level:3},{value:"QBCore.Functions.GetQBPlayers",id:"qbcorefunctionsgetqbplayers",level:3},{value:"QBCore.Functions.CreateCallback",id:"qbcorefunctionscreatecallback",level:3},{value:"QBCore.Functions.CreateUseableItem",id:"qbcorefunctionscreateuseableitem",level:3},{value:"QBCore.Functions.CanUseItem",id:"qbcorefunctionscanuseitem",level:3},{value:"QBCore.Functions.UseItem",id:"qbcorefunctionsuseitem",level:3},{value:"QBCore.Functions.Kick",id:"qbcorefunctionskick",level:3},{value:"QBCore.Functions.AddPermission",id:"qbcorefunctionsaddpermission",level:3},{value:"QBCore.Functions.RemovePermission",id:"qbcorefunctionsremovepermission",level:3},{value:"QBCore.Functions.HasPermission",id:"qbcorefunctionshaspermission",level:3},{value:"QBCore.Functions.GetPermission",id:"qbcorefunctionsgetpermission",level:3},{value:"QBCore.Functions.IsPlayerBanned",id:"qbcorefunctionsisplayerbanned",level:3},{value:"QBCore.Functions.IsLicenseInUse",id:"qbcorefunctionsislicenseinuse",level:3}],u={toc:c},d="wrapper";function p(e){let{components:n,...r}=e;return(0,o.kt)(d,(0,t.Z)({},u,r,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"-server-function-reference"},"\ud83d\udda5 Server Function Reference"),(0,o.kt)("h3",{id:"qbcorefunctionsgetcoords"},"QBCore.Functions.GetCoords"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Get the coords of a passed entity")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-lua"},"function QBCore.Functions.GetCoords(entity)\n    local coords = GetEntityCoords(entity, false)\n    local heading = GetEntityHeading(entity)\n    return vector4(coords.x, coords.y, coords.z, heading)\nend\n\n-- Example\n\nlocal ped = GetPlayerPed(source)\nlocal coords = QBCore.Functions.GetCoords(ped)\nprint(coords)\n")),(0,o.kt)("h3",{id:"qbcorefunctionsgetidentifier"},"QBCore.Functions.GetIdentifier"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Get a specific identifier of a player")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-lua"},"function QBCore.Functions.GetIdentifier(source, idtype)\n    local idtype = idtype or QBConfig.IdentifierType\n    for key, value in pairs(GetPlayerIdentifiers(source)) do\n        if string.find(value, idtype) then\n            return identifier\n        end\n    end\n    return nil\nend\n\n-- Example\n\nlocal identifier = QBCore.Functions.GetIdentifier(source, 'license')\nprint(identifier)\n\nOR -- defaults to the identifier in the config of qb-core\n\nlocal identifier = QBCore.Functions.GetIdentifier(source)\nprint(identifier)\n")),(0,o.kt)("h3",{id:"qbcorefunctionsgetsource"},"QBCore.Functions.GetSource"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Get a players source by identifer")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-lua"},"function QBCore.Functions.GetSource(identifier)\n    for key, value in pairs(QBCore.Players) do\n        local identifiers = GetPlayerIdentifiers(key)\n        for _, id in pairs(identifiers) do\n            if identifier == id then\n                return key\n            end\n        end\n    end\n    return 0\nend\n\n-- Example\n\nlocal identifier = QBCore.Functions.GetIdentifier(source, 'license')\nlocal playerSource = QBCore.Functions.GetSource(identifier)\nprint(playerSource)\n")),(0,o.kt)("h3",{id:"qbcorefunctionsgetplayer"},"QBCore.Functions.GetPlayer"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Get a player by their source and access their data")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-lua"},"function QBCore.Functions.GetPlayer(source)\n    local src = source\n    if type(src) == 'number' then\n        return QBCore.Players[src]\n    else\n        return QBCore.Players[QBCore.Functions.GetSource(src)]\n    end\nend\n\n-- Example\n\nlocal Player = QBCore.Functions.GetPlayer(source)\nprint(QBCore.Debug(Player))\n\nOR -- access some player data\n\nlocal Player = QBCore.Functions.GetPlayer(source)\nprint(Player.PlayerData.citizenid)\n")),(0,o.kt)("h3",{id:"qbcorefunctionsgetplayerbycitizenid"},"QBCore.Functions.GetPlayerByCitizenId"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Get a player by their citizen id and access their data (must be online)")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-lua"},"function QBCore.Functions.GetPlayerByCitizenId(citizenid)\n    for key, value in pairs(QBCore.Players) do\n        if QBCore.Players[key].PlayerData.citizenid == citizenid then\n            return QBCore.Players[key]\n        end\n    end\n    return nil\nend\n\n-- Example\n\nlocal Player = QBCore.Functions.GetPlayerByCitizenId('ONZ55343')\nprint(QBCore.Debug(Player))\n\nOR -- access some player data\n\nlocal Player = QBCore.Functions.GetPlayerByCitizenId('ONZ55343')\nprint(Player.PlayerData.license)\n")),(0,o.kt)("h3",{id:"qbcorefunctionsgetplayerbyphone"},"QBCore.Functions.GetPlayerByPhone"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Get a player by their phone number (must be online)")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-lua"},"function QBCore.Functions.GetPlayerByPhone(number)\n    for key, value in pairs(QBCore.Players) do\n        if QBCore.Players[key].PlayerData.charinfo.phone == number then\n            return QBCore.Players[key]\n        end\n    end\n    return nil\nend\n\n-- Example\n\nlocal Player = QBCore.Functions.GetPlayerByPhone('1264756087')\nprint(QBCore.Debug(Player))\n\nOR -- access some player data\n\nlocal Player = QBCore.Functions.GetPlayerByPhone('1264756087')\nprint(Player.PlayerData.license)\n")),(0,o.kt)("h3",{id:"qbcorefunctionsgetplayers"},"QBCore.Functions.GetPlayers"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Get all player IDs in the server (deprecated method)")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-lua"},"function QBCore.Functions.GetPlayers()\n    local sources = {}\n    for key, value in pairs(QBCore.Players) do\n        sources[#sources + 1] = key\n    end\n    return sources\nend\n\n-- Example\n\nlocal Players = QBCore.Functions.GetPlayers()\nprint(QBCore.Debug(Players))\n")),(0,o.kt)("h3",{id:"qbcorefunctionsgetqbplayers"},"QBCore.Functions.GetQBPlayers"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Access the table of all active players on the server (preferred to above)")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-lua"},"function QBCore.Functions.GetQBPlayers()\n    return QBCore.Players\nend\n\n-- Example\n\nlocal Players = QBCore.Functions.GetQBPlayers()\nprint(QBCore.Debug(Players))\n")),(0,o.kt)("h3",{id:"qbcorefunctionscreatecallback"},"QBCore.Functions.CreateCallback"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Creates a callback which is used on the client-side code with QBCore.Functions.TriggerCallback")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-lua"},"function QBCore.Functions.CreateCallback(name, cb)\n    QBCore.ServerCallbacks[name] = cb\nend\n\n-- Example\n\nQBCore.Functions.CreateCallback('callbackName', function(source, cb)\n    cb('Ok')\nend)\n")),(0,o.kt)("h3",{id:"qbcorefunctionscreateuseableitem"},"QBCore.Functions.CreateUseableItem"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Register an item as usable in the core")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-lua"},"function QBCore.Functions.CreateUseableItem(item, cb)\n    QBCore.UseableItems[item] = cb\nend\n\n-- Example\n\nQBCore.Functions.CreateUseableItem('my_cool_item', function(source, item)\n    local Player = QBCore.Functions.GetPlayer(source)\n    if not Player.Functions.GetItemByName(item.name) then return end\n    -- Trigger code here for what item should do\nend)\n")),(0,o.kt)("h3",{id:"qbcorefunctionscanuseitem"},"QBCore.Functions.CanUseItem"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Check if an item is registered as usable before attempting use")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-lua"},"function QBCore.Functions.CanUseItem(item)\n    return QBCore.UseableItems[item]\nend\n\n-- Example\n\nlocal canUse = QBCore.Functions.CanUseItem('my_cool_item')\nprint(canUse)\n\nOR\n\nlocal canUse = QBCore.Functions.CanUseItem('my_cool_item')\nif not canUse then return end\n-- Trigger code here\n")),(0,o.kt)("h3",{id:"qbcorefunctionsuseitem"},"QBCore.Functions.UseItem"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Trigger an item to be used on the player")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-lua"},"function QBCore.Functions.UseItem(source, item)\n    QBCore.UseableItems[item.name](source, item)\nend\n\n-- Example\n\nlocal Player = QBCore.Functions.GetPlayer(source)\nif not Player.Functions.GetItemByName('my_cool_item') then return end\nQBCore.Functions.UseItem(source, 'my_cool_item')\n")),(0,o.kt)("h3",{id:"qbcorefunctionskick"},"QBCore.Functions.Kick"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Kick a player from the server")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-lua"},"function QBCore.Functions.Kick(source, reason, setKickReason, deferrals)\n    local src = source\n    reason = '\\n'..reason..'\\n\ud83d\udd38 Check our Discord for further information: '..QBCore.Config.Server.discord\n    if setKickReason then\n        setKickReason(reason)\n    end\n    CreateThread(function()\n        if deferrals then\n            deferrals.update(reason)\n            Wait(2500)\n        end\n        if src then\n            DropPlayer(src, reason)\n        end\n        local i = 0\n        while (i <= 4) do\n            i = i + 1\n            while true do\n                if src then\n                    if(GetPlayerPing(src) >= 0) then\n                        break\n                    end\n                    Wait(100)\n                    CreateThread(function() \n                        DropPlayer(src, reason)\n                    end)\n                end\n            end\n            Wait(5000)\n        end\n    end)\nend\n\n-- Example\n\nQBCore.Functions.Kick(playerId, 'You messed up', true, true)\n")),(0,o.kt)("h3",{id:"qbcorefunctionsaddpermission"},"QBCore.Functions.AddPermission"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Give a player a specific permission level (per session only)")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-lua"},"function QBCore.Functions.AddPermission(source, permission)\n    local license = QBCore.Functions.GetIdentifier(source, 'license')\n    ExecuteCommand(('add_principal identifier.%s qbcore.%s'):format(license, permission))\n    QBCore.Commands.Refresh(source)\nend\n\n-- Example\n\nlocal Player = QBCore.Functions.GetPlayer(playerId)\nlocal permission = 'admin'\nQBCore.Functions.AddPermission(Player.PlayerData.source, permission)\n")),(0,o.kt)("h3",{id:"qbcorefunctionsremovepermission"},"QBCore.Functions.RemovePermission"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Remove all of the players permissions on the server (per session only)")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-lua"},"function QBCore.Functions.RemovePermission(source, permission)\n    local src = source\n    local license = QBCore.Functions.GetIdentifier(src, 'license')\n    if permission then\n        if IsPlayerAceAllowed(src, permission) then\n            ExecuteCommand(('remove_principal identifier.%s qbcore.%s'):format(license, permission))\n            QBCore.Commands.Refresh(src)\n        end\n    else\n        for k,v in pairs(QBCore.Config.Server.Permissions) do\n            if IsPlayerAceAllowed(src, v) then\n                ExecuteCommand(('remove_principal identifier.%s qbcore.%s'):format(license, v))\n                QBCore.Commands.Refresh(src)\n            end\n        end\n    end\nend\n\n-- Example\n\nlocal Player = QBCore.Functions.GetPlayer(playerId)\nlocal permission = 'admin'\nQBCore.Functions.RemovePermission(Player.PlayerData.source, permission)\n")),(0,o.kt)("h3",{id:"qbcorefunctionshaspermission"},"QBCore.Functions.HasPermission"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Check if a player has the permission level needed")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-lua"},"function QBCore.Functions.HasPermission(source, permission)\n    if IsPlayerAceAllowed(source, permission) then return true end\n    return false\nend\n\n-- Example\n\nlocal hasPerms = QBCore.Functions.HasPermission(source, 'admin')\nprint(hasPerms)\n\nOR -- using as a condition\n\nlocal hasPerms = QBCore.Functions.HasPermission(source, 'admin')\nif not hasPerms then return end\n-- Trigger code here\n")),(0,o.kt)("h3",{id:"qbcorefunctionsgetpermission"},"QBCore.Functions.GetPermission"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Get a player's permission level")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-lua"},"function QBCore.Functions.GetPermission(source)\n    local src = source\n    local perms = {}\n    for key, value in pairs (QBCore.Config.Server.Permissions) do\n        if IsPlayerAceAllowed(src, value) then\n            perms[value] = true\n        end\n    end\n    return perms\nend\n\n-- Example\n\nlocal permissions = QBCore.Functions.GetPermission(source)\nprint(QBCore.Debug(permissions))\n\nOR -- using as a condition\n\nlocal permissions = QBCore.Functions.GetPermission(source)\nfor key, value in pairs(permissions) do\n    if value == true then\n        print(key)\n    end\nend\n")),(0,o.kt)("h3",{id:"qbcorefunctionsisplayerbanned"},"QBCore.Functions.IsPlayerBanned"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Check if a player is banned (used for connection)")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-lua"},"function QBCore.Functions.IsPlayerBanned(source)\n    local plicense = QBCore.Functions.GetIdentifier(source, 'license')\n    local result = MySQL.Sync.fetchSingle('SELECT * FROM bans WHERE license = ?', { plicense })\n    if not result then return false end\n    if os.time() < result.expire then\n        local timeTable = os.date('*t', tonumber(result.expire))\n        return true, 'You have been banned from the server:\\n' .. result.reason .. '\\nYour ban expires ' .. timeTable.day .. '/' .. timeTable.month .. '/' .. timeTable.year .. ' ' .. timeTable.hour .. ':' .. timeTable.min .. '\\n'\n    else\n        MySQL.Async.execute('DELETE FROM bans WHERE id = ?', { result.id })\n    end\n    return false\nend\n\n-- Example\n\nlocal isBanned = QBCore.Functions.IsPlayerBanned(source)\nprint(isBanned)\n")),(0,o.kt)("h3",{id:"qbcorefunctionsislicenseinuse"},"QBCore.Functions.IsLicenseInUse"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Prevent duplicate licenses on the server (used for connection)")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-lua"},"function QBCore.Functions.IsLicenseInUse(license)\n    local players = GetPlayers()\n    for key, value in pairs(players) do\n        local identifiers = GetPlayerIdentifiers(value)\n        for _, id in pairs(identifiers) do\n            if string.find(id, 'license') then\n                if id == license then\n                    return true\n                end\n            end\n        end\n    end\n    return false\nend\n\n-- Example\n\nlocal license = QBCore.Functions.GetIdentifier(source, 'license')\nlocal isUsed = QBCore.Functions.IsLicenseInUse(license)\nprint(isUsed)\n")))}p.isMDXComponent=!0}}]);